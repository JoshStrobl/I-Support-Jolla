var isupportjolla;(function(a){(function(a){a.CreateError=function(a,e){var b=document.createElement("div");b.setAttribute("data-isupportjolla-error",a);b.textContent=e;return b}})(a.errors||(a.errors={}))})(isupportjolla||(isupportjolla={}));var twttr;
(function(a){(function(d){d.RequestHandler=function(a,e){var b=e.target;4==b.readyState&&(200==b.status?b=0!==b.responseText.indexOf("{")?b.responseText:JSON.parse(b.responseText):(b={Error:"The server is currently not reachable."},navigator.onLine||(b.Error+=" We have detected you are offline.")),"function"==typeof a&&a(b))};d.Request=function(c,e,b,d){var f=new XMLHttpRequest;f.open(e,c,!0);"function"==typeof d&&(f.onreadystatechange=a.net.RequestHandler.bind(this,d));"object"==typeof b&&(b=JSON.stringify(b));
f.send(b)}})(a.net||(a.net={}))})(isupportjolla||(isupportjolla={}));
(function(a){(function(d){d.Init=function(){a.letters.BackButton=document.querySelector('div[data-isupportjolla-component="back-button"]');a.letters.PublishedLetterContainer=document.querySelector('div[data-isupportjolla-component="letter-container"]');a.letters.PublishedLetter=a.letters.PublishedLetterContainer.querySelector('div[data-isupportjolla-component="published-letter"]');a.letters.PublishedLetterContent=a.letters.PublishedLetterContainer.querySelector('div[data-isupportjolla-component="published-letter-content"]');a.letters.BackButton.addEventListener("click",
a.letters.HideLetter);a.letters.LoadLettersUX()};d.LoadLettersUX=function(){a.net.Request("http://isupportjolla.com/letters","POST",{Action:"get",LetterId:"all"},function(c){if("undefined"==typeof c.Error){var e=Object.keys(c);if(0!==e.length){var b=document.createElement("div");b.setAttribute("data-isupportjolla-component","letters-list-items");a.PrimaryContent.querySelector('div[data-isupportjolla-component="letters-list"]').appendChild(b);for(var d=0;d<e.length;d++){var f=e[d],g=c[f],h=a.letters.CreateLetterListItem(g);
b.insertBefore(h,b.firstChild);h.querySelector('div[data-isupportjolla-component="letter-metadata"] > span').addEventListener("click",a.letters.LoadLetter.bind(this,f,g))}}else c.Error="No Letters are currently available."}"string"==typeof c.Error&&(c=a.errors.CreateError("server-unreachable",c.Error),a.PrimaryContent.appendChild(c))})};d.CreateLetterListItem=function(c){var e=document.createElement("div");e.setAttribute("data-isupportjolla-component","letters-list-item");var b=a.letters.CreateLetterMetadata(c),
d=document.createElement("p");d.textContent=decodeURIComponent(c.Description);e.appendChild(b);e.appendChild(d);return e};d.CreateLetterMetadata=function(a){var e=document.createElement("div");e.setAttribute("data-isupportjolla-component","letter-metadata");var b=document.createElement("img");b.setAttribute("src",a.Author.Avatar);e.appendChild(b);b=document.createElement("span");b.textContent=a.Title;e.appendChild(b);b=document.createElement("b");b.textContent=a.Author.Name;e.appendChild(b);b=document.createElement("u");
b.textContent=(new Date(1E3*a.Date)).toUTCString();e.appendChild(b);return e};d.LoadLetter=function(c,e){var b=function(b,c){if("object"!==typeof c){var d=a.letters.CreateLetterMetadata(e);a.letters.PublishedLetter.insertBefore(d,a.letters.PublishedLetterContent);a.letters.PublishedLetterContent.innerHTML=c;a.PrimaryContent.querySelector('div[data-isupportjolla-component="letters-list-items"]').setAttribute("hide","");a.letters.PublishedLetterContainer.setAttribute("show","true")}else d=a.errors.CreateError("server-unreachable",
c.Error),a.PrimaryContent.appendChild(d)}.bind(this,e);a.net.Request("http://isupportjolla.com/letters","POST",{Action:"get",LetterId:c},b)};d.HideLetter=function(){var c=a.PrimaryContent.querySelector("div[data-isupportjolla-error]");null!==c?a.PrimaryContent.removeChild(c):(c=a.letters.PublishedLetter.querySelector('div[data-isupportjolla-component="letter-metadata"]'),a.letters.PublishedLetter.removeChild(c),a.letters.PublishedLetterContent.innerHTML="",a.PrimaryContent.querySelector('div[data-isupportjolla-component="letters-list-items"]').removeAttribute("hide"),
a.letters.PublishedLetterContainer.removeAttribute("show"))}})(a.letters||(a.letters={}))})(isupportjolla||(isupportjolla={}));
(function(a){(function(d){d.GenerateForm=function(){a.twitter.Form=document.querySelector('div[data-isupportjolla-component="tweet-form"]');a.twitter.FormInput=document.createElement("textarea");a.twitter.FormInput.setAttribute("placeholder","Input positive tweet with #ISupportJolla");a.twitter.FormInput.setAttribute("maxlength","140");a.twitter.FormInput.setAttribute("tabindex","1");a.twitter.FormButton=document.createElement("a");a.twitter.FormButton.setAttribute("target","_blank");a.twitter.FormButton.textContent=
"Tweet";a.twitter.FormButton.setAttribute("tabindex","2");a.twitter.Form.appendChild(a.twitter.FormInput);a.twitter.Form.appendChild(a.twitter.FormButton)};d.GenerateTimeline=function(){var a=document.querySelector('div[data-isupportjolla-component="sailor-feed-timeline"]');"undefined"!==typeof twttr&&"undefined"!==typeof twttr.widgets?twttr.widgets.createTimeline("675772340106608640",a,{height:400,border:"#ffffff",chrome:"noheader,nofooter,noborders,transparent",tweetLimit:10}):(a.setAttribute("data-isupportjolla-error",
"twttr"),a.textContent="Twitter widget being blocked by browser. Lemme guess, Ghostery?")};d.TrackInput=function(){if(-1!==a.twitter.FormInput.value.indexOf("#ISupportJolla")){var c=encodeURIComponent(a.twitter.FormInput.value),c="https://twitter.com/share?related=JoshStrobl"+encodeURIComponent(",")+"JollaHQ&text="+c;a.twitter.FormButton.setAttribute("href",c)}else a.twitter.FormButton.removeAttribute("href")}})(a.twitter||(a.twitter={}))})(isupportjolla||(isupportjolla={}));
(function(a){a.Init=function(){a.PrimaryContent=document.querySelector('div[data-isupportjolla-component="primary-content"]');a.Sidepane=document.querySelector('div[data-isupportjolla-component="sidepane"]');a.twitter.GenerateForm();a.twitter.GenerateTimeline();a.twitter.FormInput.addEventListener("input",a.twitter.TrackInput);-1!==window.location.toString().indexOf("letters")&&a.letters.Init()}})(isupportjolla||(isupportjolla={}));
